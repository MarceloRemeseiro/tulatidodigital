---
---
<button id="theme-toggle" class="p-2 rounded-md hover:bg-foreground/10 transition-colors" aria-label="Cambiar tema">
  <span class="sun-icon">☀️</span>
  <span class="moon-icon">🌙</span>
</button>

<script>
  const applyTheme = () => {
    // 1. Lee el tema desde localStorage, o usa 'light' si no hay nada.
    const theme = localStorage.getItem('theme') || 'light';
    // 2. Aplica el tema al documento.
    document.documentElement.setAttribute('data-theme', theme);
  };

  const toggleTheme = () => {
    const currentTheme = localStorage.getItem('theme') || 'light';
    const newTheme = currentTheme === 'light' ? 'dark' : 'light';
    localStorage.setItem('theme', newTheme);
    applyTheme(); // Vuelve a aplicar para que el cambio sea instantáneo.
  };

  // Este evento se dispara en la carga inicial Y después de cada navegación de ViewTransitions.
  document.addEventListener('DOMContentLoaded', () => {
    // Siempre nos aseguramos de que el tema correcto esté aplicado.
    applyTheme();

    // Y siempre nos aseguramos de que el botón funcione.
    const themeToggle = document.getElementById('theme-toggle');
    if (themeToggle) {
      themeToggle.addEventListener('click', toggleTheme);
    }
  });
</script> 